<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Leafii"><meta name="copyright" content="Leafii"><meta name="generator" content="Hexo 6.2.0"><meta name="theme" content="hexo-theme-yun"><title>qwq | LeafiiのBlog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.3.3/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://fastly.jsdelivr.net/npm/@unocss/runtime/mini.global.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...true?.options,
  });
});</script><link rel="icon" type="image/png" href="../../../../favicon.ico"><link rel="mask-icon" href="../../../../favicon.ico" color="#0078E7"><link rel="preload" href="../../../../css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="../../../../js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"leafii.top","root":"/","title":["Leafii","の","博","客"],"version":"1.9.3","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"fireworks":{"colors":null},"vendors":{"darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="../../../../css/hexo-theme-yun.css"><script src="../../../../js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="../../../../atom.xml" title="LeafiiのBlog" type="application/atom+xml"><meta name="description" content="机器学习方法期末考试">
<meta property="og:type" content="article">
<meta property="og:title" content="qwq">
<meta property="og:url" content="2022/12/10/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E9%A2%98%E7%9B%AE%E5%8F%8A%E7%AD%94%E6%A1%88/index.html">
<meta property="og:site_name" content="LeafiiのBlog">
<meta property="og:description" content="机器学习方法期末考试">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-12-10T14:13:35.000Z">
<meta property="article:modified_time" content="2022-12-10T14:18:10.856Z">
<meta property="article:author" content="Leafii">
<meta property="article:tag" content="机器学习">
<meta name="twitter:card" content="summary"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head><body><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="../../../../js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="../../../../js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="../../../../about/" title="Leafii"><img width="96" loading="lazy" src="../../../../images/avatar.jpg" alt="Leafii"></a><div class="site-author-name"><a href="../../../../about/">Leafii</a></div><a class="site-name" href="../../../../about/site.html">LeafiiのBlog</a><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="../../../../index.html" title="我的主页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="../../../../archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">69</span></a></div><div class="site-state-item"><a href="../../../../categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><div class="site-state-item"><a href="../../../../tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">25</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="主题文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/mikutown" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:yunsenye@gmail.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=299583310" title="网易云音乐" target="_blank" style="color:#C10D0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="../../../../links/" title="友情链接" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95%E6%9C%9F%E6%9C%AB%E8%80%83%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">机器学习方法期末考试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#P-89-%E4%B9%A0%E9%A2%985-3"><span class="toc-number">1.1.</span> <span class="toc-text">P.89 习题5.3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P109-%E4%B9%A0%E9%A2%986-2"><span class="toc-number">1.2.</span> <span class="toc-text">P109 习题6.2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P-153-%E4%B9%A0%E9%A2%987-4"><span class="toc-number">1.3.</span> <span class="toc-text">P.153 习题7.4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P-192-%E4%B9%A0%E9%A2%989-3"><span class="toc-number">1.4.</span> <span class="toc-text">P.192 习题9.3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P294-%E4%B9%A0%E9%A2%9815-1"><span class="toc-number">1.5.</span> <span class="toc-text">P294 习题15.1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P320-%E4%B9%A0%E9%A2%9816-2"><span class="toc-number">1.6.</span> <span class="toc-text">P320 习题16.2</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https:/leafii.top"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Leafii"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="LeafiiのBlog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">qwq</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2022-12-10 22:13:35" itemprop="dateCreated datePublished" datetime="2022-12-10T22:13:35+08:00">2022-12-10</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">15m</span></span></span><div class="post-classify"><span class="post-tag"><a class="tag-item" href="../../../../tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">机器学习</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="机器学习方法期末考试"><a href="#机器学习方法期末考试" class="headerlink" title="机器学习方法期末考试"></a>机器学习方法期末考试</h2><span id="more"></span>

<h3 id="P-89-习题5-3"><a href="#P-89-习题5-3" class="headerlink" title="P.89 习题5.3"></a>P.89 习题5.3</h3><blockquote>
<p>证明CART剪枝算法中，当$\alpha$确定时，存在唯一的最小子树$T_\alpha$使损失函数$C_\alpha {(T)}$最小。</p>
</blockquote>
<p><strong>解答：</strong></p>
<p>采用反证法：</p>
<p><strong>存在性</strong>易证，在特征有限，数据集有限的情况下，由于能生成的决策树数量有限，每一棵树都对应某一个$C_\alpha(T_i)$损失函数。此之中一定存在一个最小的损失函数$C_\alpha(T)$.</p>
<p><strong>唯一性</strong>：对于决策树生成算法生成原始数$T$,假设存在2棵不同的最小子树$T_{\alpha_1}$和$T_{\alpha_2}$使得损失函数$C_\alpha(T)$最小化。</p>
<p>由于两颗子树不相同，所以它们的剪枝方法$s_1 \ne s_2$，由于根据CART剪纸算法，其中剪枝的每一步都使得损失函数$C_\alpha(T)$变低。所以令$s_* &#x3D; s_1\cup s_2$，由$s_*$剪枝法生成的决策树为$T_*$。那么就会有$C_\alpha(T_*) &lt; C_\alpha(T_{\alpha_1})$以及$C_\alpha(T_*) &lt; C_\alpha(T_{\alpha_2})$.所以与假设$T_{\alpha_1}$和$T_{\alpha_2}$是使损失函数最小化的最小字数矛盾。</p>
<p>由此，得证。</p>
<hr>
<h3 id="P109-习题6-2"><a href="#P109-习题6-2" class="headerlink" title="P109 习题6.2"></a>P109 习题6.2</h3><blockquote>
<p>写出逻辑斯谛回归模型学习的梯度下降算法。</p>
</blockquote>
<p><strong>解答：</strong></p>
<p>假设给定的数据集为$X &#x3D; {x^{(1)},x^{(2)}, …, x^{(m)}}$，对应的标签为$Y &#x3D; {y^{(1)},y^{(2)},…,y^{(m)}}$，其中$x^{(i)} &#x3D; (x_1^{(i)},…,x_{n-1}^{(i)},1) \in R^n$,$y^{(i)} \in {0, 1}$，特别需要说明的是，这里把常数项放到了数据集，所以最后一个分量都是1，需要学习的参数记为$w &#x3D; (w_1, w_2, …, w_n)$.根据课本93页的推导可知，对数似然函数为<br>$$<br>L(w) &#x3D; \sum_{i&#x3D;1}^{N}[y_i(w \cdot x_i) - log(1 + exp(w \cdot x_i))]<br>$$<br>需要对$L(w)$求偏导数<br>$$<br>\nabla L(w) &#x3D; (\frac{\partial L}{\partial w_1},…,\frac{\partial L}{\partial w_n})<br>$$<br>其中<br>$$<br>\frac{\partial L}{\partial w_i} &#x3D; x_i^{(i)}y - \frac{w_iexp{w_1x_1^{(i)} + … + w_nx_n^{(i)}}}{1 + exp{w_1x_1^{(i)} + … + w_n x_n^{(i)}}}<br>$$</p>
<p>从而通过设置步长$\alpha$,终止迭代阈值$eps$，可以设置如下算法</p>
<ul>
<li>设定迭代起点x初值</li>
<li>根据上面写出来的公式，得到对应位置的梯度值$w$</li>
<li>根据迭代步长算出新的梯度算出下个迭代点$x &#x3D; x + \alpha w$</li>
<li>判断$\alpha |w| &lt; eps$是否成立，成立则结束，否则返回第二步</li>
</ul>
<hr>
<h3 id="P-153-习题7-4"><a href="#P-153-习题7-4" class="headerlink" title="P.153 习题7.4"></a>P.153 习题7.4</h3><blockquote>
<p>证明内积的正整数幂函数：$K(x,z) &#x3D; (x \cdot z)^p$是正定核函数，这里$p$是正整数，$x,z \in R^n$.</p>
</blockquote>
<p><strong>解答:</strong></p>
<p>首先回顾到，由映射函数$\phi(x) &#x3D; x$所带来的函数</p>
<p>$K(x_i, x_j) &#x3D; \phi(x_i)\cdot \phi(x_j) &#x3D; x_i \cdot x_j$是正定核函数。</p>
<p>使用数学归纳来证明$K(x,z) &#x3D; (x \cdot z)^p$所形成的Gram矩阵是半正定矩阵，由此得到$K(x,z)$是正定核函数。</p>
<p>对于任意${c_i}<em>{i \in {1,2,…,n}}\in \mathbb R^n$，我们有<br>$$<br>\begin{aligned}\sum</em>{i,j}^{n}c_ic_jK(x_i,x_j) &amp;&#x3D; \sum_{i,j}^{n}c_ic_j(x_i \cdot x_j)^p \ &amp;&#x3D; \sum_{i}^{n}c_ix_i\sum_{j}^{n}c_jx_j(x_i \cdot x_j)^{p-1}\end{aligned}<br>$$<br>注意到$\sum_{i}^{n}c_ix_i\sum_{j}^{n}c_jx_j &#x3D; \sum_{i}^{n}||c_ix_i||^2 \ge 0$,所以问题降次到$K(x,z) &#x3D; (x,z)^{p-1}$.由此不断降次直到$p&#x3D;1$,得证$K(x,z)$所形成的Gram矩阵为半正定矩阵，所以$K(x,z)$是正定核函数.</p>
<hr>
<h3 id="P-192-习题9-3"><a href="#P-192-习题9-3" class="headerlink" title="P.192 习题9.3"></a>P.192 习题9.3</h3><blockquote>
<p>已知观测数据-67,-48,6,8,14,16,23,24,28,29,41,49,56,60,75 试估计两个分量的高斯混合模型的5个参数.</p>
</blockquote>
<p><strong>解答：</strong></p>
<blockquote>
<p>算法9.2（高斯混合模型参数估计的EM算法）（P186）</p>
</blockquote>
<p>本题目的模型由两个高斯模型混合而成，5个参数指的是两个高斯模型的参数$\mu_0, \sigma_0, \mu_1, \sigma_1$，另外还有其对应的系数$\alpha_0, \alpha_1(\alpha_0 + \alpha_1 &#x3D; 1)$，相当于只需要求一个系数。</p>
<p>初值设置为$\sigma &#x3D; 1.0, \mu &#x3D; 0.5, \alpha &#x3D; 0.5$</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> norm

y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
K <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment"># 两个高斯</span>
N <span class="token operator">=</span> <span class="token number">15</span>  <span class="token comment"># y有15个数据</span>

<span class="token comment"># 参数初始化</span>
mu <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sigma <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
alpha <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    gm <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> K<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># E 步</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>K<span class="token punctuation">)</span><span class="token punctuation">:</span>
            gm<span class="token punctuation">[</span>j<span class="token punctuation">,</span> k<span class="token punctuation">]</span> <span class="token operator">=</span> alpha<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> norm<span class="token punctuation">(</span>mu<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> sigma<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pdf<span class="token punctuation">(</span>y<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#使用scipy实现高斯分布</span>
        gm<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">/=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># gm[j,:] = gm[j,:] /sum(gm[j,:])</span>

    <span class="token comment"># M 步</span>
    mu2 <span class="token operator">=</span> y<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>gm<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">)</span>
    alpha2 <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">)</span> <span class="token operator">/</span> N
    sigma2 <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    sigma2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> mu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sigma2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> mu<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gm<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">#判断是否收敛</span>
    <span class="token keyword">if</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mu <span class="token operator">-</span> mu2<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>sigma <span class="token operator">-</span> sigma2<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>alpha <span class="token operator">-</span> alpha2<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.01</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>

    mu <span class="token operator">=</span> mu2
    sigma <span class="token operator">=</span> sigma2
    alpha <span class="token operator">=</span> alpha2
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第%d次迭代\nalpha_0=%f,mu_0=%f,sigma_0=%f\nalpha_1=%f,mu_1=%f,sigma_1=%f\n"</span>
          <span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> alpha<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sigma<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> alpha<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mu<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sigma<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<p>运行结果：</p>
<pre class="language-第1次迭代" data-language="第1次迭代"><code class="language-第1次迭代">第1次迭代
alpha_0&#x3D;0.500000,mu_0&#x3D;20.933333,sigma_0&#x3D;1747.183333
alpha_1&#x3D;0.500000,mu_1&#x3D;20.933333,sigma_1&#x3D;1747.183333

第2次迭代
alpha_0&#x3D;0.500000,mu_0&#x3D;20.933333,sigma_0&#x3D;1329.662222
alpha_1&#x3D;0.500000,mu_1&#x3D;20.933333,sigma_1&#x3D;1329.662222</code></pre>

<hr>
<h3 id="P294-习题15-1"><a href="#P294-习题15-1" class="headerlink" title="P294 习题15.1"></a>P294 习题15.1</h3><blockquote>
<p>试求矩阵 $A&#x3D;\begin{bmatrix}1&amp;2&amp;0 \ 2 &amp; 0 &amp; 2\end{bmatrix}$的奇异值分解。</p>
</blockquote>
<p><strong>解答:</strong></p>
<p>求$A^T$更方便，然后再求转置即可.</p>
<p>令$B &#x3D; A^T$，则：<br>$$<br>K &#x3D; B^TB &#x3D; AA^T &#x3D; \begin{bmatrix}1 &amp; 2 &amp; 0 \ 2 &amp; 0 &amp; 2\end{bmatrix}\begin{bmatrix}1 &amp; 2 \ 2 &amp; 0 \0 &amp; 2\end{bmatrix} &#x3D; \begin{bmatrix}5 &amp; 2 \ 2 &amp; 8\end{bmatrix}<br>$$</p>
<p>$$<br>\Lambda &#x3D; \begin{bmatrix}9 &amp;  \ \  &amp; 4\end{bmatrix} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ V &#x3D; \begin{bmatrix}\frac{\sqrt{5}}{5} &amp; \frac{2\sqrt{5}}{5} \ \frac{2\sqrt{5}}{5} &amp; -\frac{\sqrt{5}}{5}\end{bmatrix} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \Sigma &#x3D; \begin{bmatrix}3 &amp; 0 \ 0 &amp; 2 \ 0 &amp; 0\end{bmatrix}<br>$$</p>
<p>$$<br>\mu_1 &#x3D; \frac{1}{3} BV_1 &#x3D; \frac{1}{3}\begin{bmatrix}1 &amp; 2 \ 2 &amp; 0 \ 0 &amp; 2\end{bmatrix}\begin{bmatrix}\frac{\sqrt{5}}{5} \ \frac{2\sqrt{5}}{5}\end{bmatrix} &#x3D; \begin{bmatrix} \frac{\sqrt{5}}{3}\ \frac{2\sqrt{5}}{15} \  \frac{4\sqrt{5}}{15}\end{bmatrix}<br>$$</p>
<p>$$<br>\mu_2 &#x3D; \frac{1}{2} BV_2 &#x3D; \frac{1}{2}\begin{bmatrix}1 &amp; 2 \ 2 &amp; 0 \ 0 &amp; 2\end{bmatrix}\begin{bmatrix}\frac{2\sqrt{5}}{5} \ -\frac{\sqrt{5}}{5}\end{bmatrix} &#x3D; \begin{bmatrix} 0 \ \frac{2\sqrt{5}}{5} \  -\frac{\sqrt{5}}{5}\end{bmatrix}<br>$$</p>
<p>又因为:<br>$$<br>B^TX &#x3D; \begin{bmatrix}1 &amp; 2 &amp; 0 \ 2 &amp; 0 &amp; 2 \end{bmatrix}\begin{bmatrix}x_1 \ x_2 \ x_3 \end{bmatrix} &#x3D; 0<br>$$<br>解得:<br>$$<br>\begin{cases}x_1 &#x3D; -1 \ x_2 &#x3D; \frac{1}{2} \ x_3 &#x3D; 1\end{cases}<br>$$<br>单位正交化可得:<br>$$<br>u_3 &#x3D; \begin{bmatrix}-1 \ \frac{1}{2} \ 1 \end{bmatrix} \to \begin{bmatrix} -\frac{2}{3} \ \frac{1}{3} \ \frac{2}{3} \end{bmatrix}<br>$$<br>此时的$u_3$与$u_1, u_2$正交并归一化.</p>
<p>因此:<br>$$<br>U &#x3D; \begin{bmatrix}u_1, u_2, u_3 \end{bmatrix} &#x3D; \begin{bmatrix}\frac{\sqrt{5}}{3} &amp; 0 &amp; -\frac{2}{3} \ \frac{2\sqrt{5}}{15} &amp; \frac{2\sqrt{5}}{5} &amp; \frac{1}{3} \ \frac{4\sqrt{5}}{15} &amp; -\frac{\sqrt{5}}{5} &amp; \frac{2}{3} \end{bmatrix}<br>$$<br>得:<br>$$<br>B &#x3D; U\Sigma V &#x3D;  \begin{bmatrix}\frac{\sqrt{5}}{3} &amp; 0 &amp; -\frac{2}{3} \ \frac{2\sqrt{5}}{15} &amp; \frac{2\sqrt{5}}{5} &amp; \frac{1}{3} \ \frac{4\sqrt{5}}{15} &amp; -\frac{\sqrt{5}}{5} &amp; \frac{2}{3} \end{bmatrix}\begin{bmatrix}3 &amp; 0 \ 0 &amp; 2 \ 0 &amp; 0\end{bmatrix}\begin{bmatrix}\frac{\sqrt{5}}{5} &amp; \frac{2\sqrt{5}}{5} \ \frac{2\sqrt{5}}{5} &amp; -\frac{\sqrt{5}}{5}\end{bmatrix}<br>$$<br>因此:<br>$$<br>A &#x3D; B^T &#x3D; (U\Sigma V)^T &#x3D; V^T\Sigma^TU^T &#x3D; \begin{bmatrix}\frac{\sqrt{5}}{5} &amp; \frac{2\sqrt{5}}{5} \ \frac{2\sqrt{5}}{5} &amp; -\frac{\sqrt{5}}{5}\end{bmatrix} \begin{bmatrix}3 &amp; 0 &amp; 0\ 0 &amp; 2 &amp; 0 \end{bmatrix}\begin{bmatrix}\frac{\sqrt{5}}{3} &amp; \frac{2\sqrt{5}}{15} &amp; \frac{4\sqrt{5}}{15} \ 0 &amp; \frac{2\sqrt{5}}{5} &amp; -\frac{\sqrt{5}}{5} \ -\frac{2}{3} &amp; \frac{1}{3} &amp; \frac{2}{3} \end{bmatrix}<br>$$</p>
<h3 id="P320-习题16-2"><a href="#P320-习题16-2" class="headerlink" title="P320 习题16.2"></a>P320 习题16.2</h3><blockquote>
<p>证明样本协方差矩阵$S$是总体协方差矩阵方差$\Sigma$的无偏估计.</p>
</blockquote>
<p>〇. 一个有用的结论[<a href="#ref_1">1]</a>：</p>
<p>设 $x_1,x_2,\cdots,x_n$ 是来自<strong>期望</strong>为<br>$$<br>E(x)&#x3D;E(xi)&#x3D;μ,i&#x3D;1,2,⋯,n<br>$$</p>
<p>**<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:1510180473%7D">协方差矩阵</a>**为<br>$$<br>Cov(x)&#x3D;E[(x-\mu)(x-\mu)’]&#x3D;Cov(x_i)&#x3D;E[(x_i-\mu)(x_i-\mu)’]&#x3D;\Sigma,i&#x3D;1,2,\cdots,n<br>$$<br>的总体 $x$ 的一个简单随机样本，令样本均值向量为：<br>$$<br>\overline{x}&#x3D;\frac{1}{n}(x_1+x_2+\cdots+x_n)<br>$$</p>
<p>则<strong>样本均值向量</strong>的期望与协方差矩阵如下：<br>$$<br>E(\overline{x})&#x3D;\mu\\ \tag{1}<br>$$</p>
<p>$$<br>Cov(\overline{x})&#x3D;E[(\bar{x}-\mu)(\bar{x}-\mu)’]&#x3D;\frac{1}{n}\Sigma  \\ \tag{2}<br>$$</p>
<p><strong>证明</strong>：</p>
<ol>
<li>期望：</li>
</ol>
<p>$$<br>\begin{align*} E(\bar{x})&amp;&#x3D;E(\frac{x_1+x_2+\cdots+x_n}{n}) \\ &amp;&#x3D;\frac{1}{n}(E(x_1)+E(x_2)+\cdots+E(x_n))\\ &amp;&#x3D;\frac{1}{n}(n\times\mu) \\ &amp;&#x3D; \mu \end{align*}<br>$$</p>
<ol start="2">
<li>协方差矩阵[<a href="#ref_2">2]</a>：</li>
</ol>
<p>$$<br>\begin{align*} Cov(\bar{x})&amp;&#x3D;Cov(\bar{x},\bar{x})\\ &amp;&#x3D;Cov(\sum_{i&#x3D;1}^n\frac{1}{n}x_i,\sum_{j&#x3D;1}^n\frac{1}{n}x_j)\\ &amp;&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^nCov(\frac{1}{n}x_i,\frac{1}{n}x_j) \end{align*} \  \tag{3}<br>$$</p>
<p>因为 $x_1,x_2,\cdots,x_n$ 是简单随机样本，故相互独立[<a href="#ref_3">3]</a>，进而相互不相关[<a href="#ref_4">4]</a>，即相互的协方差矩阵为0，数学语言描述：<br>$$<br>Cov(\frac{1}{n}x_i,\frac{1}{n}x_j)&#x3D;\frac{1}{n^2}Cov(x_i,x_j)&#x3D;0,i\ne j,i,j&#x3D;1,2,\cdots n \\ \tag{4}<br>$$<br>将 (4)代入 (3)式并化简，得<br>$$<br>\begin{align*} Cov(\bar{x}) &amp;&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^nCov(\frac{1}{n}x_i,\frac{1}{n}x_j)\\ &amp;&#x3D;Cov(\frac{1}{n}x_1,\frac{1}{n}x_1)+Cov(\frac{1}{n}x_1,\frac{1}{n}x_2)+\cdots+Cov(\frac{1}{n}x_1+\frac{1}{n}x_n)\\ &amp;+Cov(\frac{1}{n}x_2,\frac{1}{n}x_1)+Cov(\frac{1}{n}x_2,\frac{1}{n}x_2)+\cdots+Cov(\frac{1}{n}x_2+\frac{1}{n}x_n)\\ &amp;\cdots\\ &amp;+Cov(\frac{1}{n}x_n,\frac{1}{n}x_1)+Cov(\frac{1}{n}x_n,\frac{1}{n}x_2)+\cdots+Cov(\frac{1}{n}x_n+\frac{1}{n}x_n)\\ &amp;&#x3D;Cov(\frac{1}{n}x_1,\frac{1}{n}x_1)+Cov(\frac{1}{n}x_2,\frac{1}{n}x_2)+\cdots+Cov(\frac{1}{n}x_n,\frac{1}{n}x_n)\\ &amp;&#x3D;\sum_{i&#x3D;1}^nCov(\frac{1}{n}x_i, \frac{1}{n}x_i) \\ &amp;&#x3D;\sum_{i&#x3D;1}^n\frac{1}{n^2}Cov(x_i)\\  &amp;&#x3D;n\times \frac{1}{n^2}\Sigma\\  &amp;&#x3D;\frac{1}{n}\Sigma \end{align*}  \tag{5}<br>$$</p>
<p><strong>证毕。</strong></p>
<p>一. 无偏估计的证明[<a href="#ref_5">5]</a>：</p>
<p>样本协方差矩阵为S&#x3D;\frac{1}{n-1}\sum_{i&#x3D;1}^n(x_i-\overline{x})(x_i-\overline{x})’ \\ \tag{6}<br>$$<br>S&#x3D;\frac{1}{n-1}\sum_{i&#x3D;1}^n(x_i-\overline{x})(x_i-\overline{x})’ \\ \tag{6}<br>$$<br>令<br>$$<br>A&#x3D;\sum_{i&#x3D;1}^n(x_i-\overline{x})(x_i-\overline{x})’ \\ \tag{7}<br>$$<br>我们的目的是证明样本协方差矩阵是总体协方差矩阵的<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E6%97%A0%E5%81%8F%E4%BC%B0%E8%AE%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:1510180473%7D">无偏估计</a>，也就是证明<strong>样本协方差矩阵的期望等于总体协方差矩阵，即</strong><br>$$<br>E(S)&#x3D;E(\frac{1}{n-1}A) &#x3D;\frac{1}{n-1}E(A)&#x3D;\Sigma \ \tag{8}<br>$$<br>也就是证明<br>$$<br>E(A)&#x3D;(n-1)\Sigma \\ \tag{9}<br>$$<br><strong>证明：</strong></p>
<p>我们对 $A$ 中每一个因式里面都加上 $\mu$ 再减去$\mu$ ，得<br>$$<br>\begin{align*} E(A)&amp;&#x3D;E[ \sum_{i&#x3D;1}^n(x_i-\overline{x})(x_i-\overline{x})’]\\ &amp;&#x3D;E\left{ \sum_{i&#x3D;1}^n[(x_i-\mu)-(\overline{x}-\mu)][(x_i-\mu)-(\overline{x}-\mu)]’ \right}\\ &amp;&#x3D;E\left{ \sum_{i&#x3D;1}^n[(x_i-\mu)(x_i-\mu)’+\bar{x}\bar{x}’-x_i\bar{x}’+x_i\mu’-\bar{x}x_i’+\mu x_i’-\mu\mu’]\right}\\  &amp;&#x3D;\sum_{i&#x3D;1}^nE[(x_i-\mu)(x_i-\mu)’]+E\left[ n\bar{x}\bar{x}’-(\sum_{i&#x3D;1}^nx_i)\bar{x}’+(\sum_{i&#x3D;1}^nx_i)\mu’-\bar{x}(\sum_{i&#x3D;1}^nx_i’)+\mu(\sum_{i&#x3D;1}^nx_i’)-n\mu\mu’ \right]  \\ &amp;&#x3D;\sum_{i&#x3D;1}^nE[(x_i-\mu)(x_i-\mu)’]+E\left( n\bar{x}\bar{x}’-n\bar{x}\bar{x}’+n\bar{x}\mu’-n\bar{x}\bar{x}’+n\mu\bar{x}’-n\mu\mu’ \right)  \\ &amp;&#x3D;\sum_{i&#x3D;1}^nE[(x_i-\mu)(x_i-\mu)’] - nE(\bar{x}\bar{x}’-\bar{x}\mu’-\mu\bar{x}’+\mu\mu’)\\  &amp;&#x3D;\sum_{i&#x3D;1}^nE[(x_i-E(x_i))(x_i-E(x_i))’]-n\times E[(\bar{x}-\mu)(\bar{x}-\mu)’] \\ &amp;&#x3D;\sum_{i&#x3D;1}^nCov(x_i)-n\times E[(\bar{x}-\mu)(\bar{x}-\mu)’] \\  &amp;&#x3D;n\times\Sigma-n\times E[(\bar{x}-\mu)(\bar{x}-\mu)’]   \end{align*}\ \tag{10}<br>$$</p>
<p>将 $(1)$ , $(2)$ 式代入 $(10)$ 式，得<br>$$<br>\begin{align*}  E(A)&amp;&#x3D;n\times\Sigma-n\times E[(\bar{x}-\mu)(\bar{x}-\mu)’] \\ &amp;&#x3D;n\times \Sigma-n\times E[(\bar{x}-E(\bar{x}))(\bar{x}-E(\bar{x}))’]\\ &amp;&#x3D;n\times \Sigma-n\times Cov(\bar{x})\\ &amp;&#x3D;n\times \Sigma-n \times \frac{1}{n}\Sigma\\ &amp;&#x3D;(n-1)\Sigma \end{align*}\ \tag{11}<br>$$<br><strong>证毕。</strong></p>
<p>参考</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/400100250#ref_1_0">^</a>《实用多元统计分析（中文版 第六版）》P93</li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/400100250#ref_2_0">^</a>王学民 《应用多元统计分析 第五版》P29 性质（4）</li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/400100250#ref_3_0">^</a>《概率论与数理统计 浙大第四版》P130</li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/400100250#ref_4_0">^</a>《概率论与数理统计 浙大第四版》P108</li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/400100250#ref_5_0">^</a>王学民 《应用多元统计分析 第五版》P51</li>
</ol>
<hr>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Leafii</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="2022/12/10/机器学习题目及答案/" title="qwq">2022/12/10/机器学习题目及答案/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="../../../11/05/A-Bi-Level-Framework-for-Learning-to-Solve-Combinatorial-Optimization-on-Graph/" rel="next" title="A_Bi-Level_Framework_for_Learning_to_Solve_Combinatorial_Optimization_on_Graph"><span class="post-nav-text">A_Bi-Level_Framework_for_Learning_to_Solve_Combinatorial_Optimization_on_Graph</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Leafii</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v6.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.9.3</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="../../../../js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></div></body></html>